<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>async await</title>
</head>
<body>
    <h1>
        비동기 통신(asynchronous communication) : AJAX
    </h1>
    <ul>
        <li>
            데이터를 받는 방식(통신) : 동기통신, 비동기통신
        </li>
        <li>
            <b> 동기통신(synchronous) </b>: 동시에 일어난다
            요청을 하면 바로 응답을 받는다는 의미
        </li>
        <li>
           <b> 비동기통신(Asynchrounous) </b>: 동시에 일어나지 않는
           요청과 결과가 동시에 일어나지 않음 
           요청한 그 자리에서 결과가 주어지지 않을 수도 있다.
           <p style="color: blue; margin: 0;" >ex) 아이디 중복체크, 팝업창, 댓글처리</p>
        </li>
        <li>
            동기와 비동기의 장단점
        </li>
        <li style="color: red; margin: 0;">
            동기방식 : 설계가 간단하고 직관적, <br> 결과가 주어지기 전까지는 아무것도 못하고 대기해야 하는 단점이 있음
        </li>
        <li style="color: blue; margin: 0;">
            비동기 방식 : 설계가 복잡함, 결과가 주어지는데 시간이 걸리더라도 <br>
            그 시간동안 다른 작업을 할 수 있어 효율적
        </li>
        <hr>
        <li>
            비동기 방식 : AJAX Jquery(자바스크립트의 라이브러리) <br>
            https://cdnjs.com/libraries/jquery (여기서 검색해서 링크복사해서 쓰기)
        </li>
    </ul>
    <ul>
        <h1>
            async await :
            Promise 객체를 이용하여 데이터 통신을 편리하게 할 수 있도록 제공되는 키워드
        </h1>
        <li>
           <b> async  키워드 </b>: 함수선언 키워드(function) 앞에 사용하면 그 함수의 리턴을
            프로미스 객체 타입으로 만들어준다.
        </li>
        <li>
           <b>await 키워드 </b>: 순차적 코드 실행 시 데이터 통신과 같은 지연로딩 및 지연실행 같은 상황이 발생하면 코드 실행 순서를 순차적으로 진행할 수 있도록 보증한다.
            즉, 이전 라인의 코드실행이 완료될 때까지 다음라인은 기다리도록 하는 기능
        </li>
        <li>
            https://jsonplaceholder.typicode.com/
        </li>

    </ul>
    <h3>
        https://jsonplaceholder.typicode.com/를 활용한 async await
    </h3>

    <button type="button" id="btn">데이터 불러오기</button>
    <script>
        document.getElementById('btn').addEventListener('click',()=>{
            async function awaitEx(){
                try{
                    const resp = await fetch('https://jsonplaceholder.typicode.com/todos/1');
                    // 저 페이지의 객체가 resp에 들어옴 (response의 약자)
                    const result = await resp.text();
                    console.log(result);
                    console.log(typeof result);

                    //텍스트로 받아서 json으로(객체로 변환)바꾸기
                    let j = JSON.parse(result);
                    console.log(j); 
                    console.log(typeof j);
                    return result;


                }catch(err){
                    console.log(err);
                }finally{
                    console.log('await finish');
                }
            }

            awaitEx();
        })
    </script>
</body>
</html>